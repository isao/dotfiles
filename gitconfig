[user]
    name = Isao Yagi
    email = isao.yagi@gmail.com

[core]
    excludesfile = ~/.gitignore
    autocrlf = input

    ; tell git that trailing cr is ok, ignore in diffs et al
    whitespace = cr-at-eol

    ; https://news.ycombinator.com/item?id=11388479
    untrackedCache = true

[pager]
    ;$(brew --prefix git) -> /usr/local/opt/git
    log  = /usr/local/share/git-core/contrib/diff-highlight/diff-highlight | less
    show = /usr/local/share/git-core/contrib/diff-highlight/diff-highlight | less
    diff = /usr/local/share/git-core/contrib/diff-highlight/diff-highlight | less
    ;diff = diff-so-fancy | less --tabs=4 -RFX
    ;show = diff-so-fancy | less --tabs=4 -RFX

[interactive]
    diffFilter = /usr/local/share/git-core/contrib/diff-highlight/diff-highlight
    singleKey = true

[pack]
    ;use all cpu cores
    threads = 0

[push]
    default = current

[credential]
    ;for https git uris w/ auth
    helper = osxkeychain

[alias]
    ; list these git aliases
    aliases = config --get-regexp alias

    ; list changed files on this branch compared to argument $1 or master. Tip:
    ; use like `git changed | fzf` to access files modified on the branch, or
    ; `git changed | lint`.
    changed = !"git diff --name-only $(git merge-base ${1:-master} head)"

    ; http://stackoverflow.com/questions/3065650/whats-the-simplest-way-to-git-a-list-of-conflicted-files
    conflicts = "diff --name-only --diff-filter=U"

    ; in every repo reachable from cwd, do fetch-all
    fetchcrazy = !"find . -type d -name .git -execdir git fetch --all -v \\;"

    ; log fuller
    lf = log --graph --stat --decorate --pretty=fuller

    ; log compact oneline
    ; %cd               -> 2017-06014
    ; %C(auto)%h        -> 5259c11bd5 short commit sha
    ; %<(12,trunc)%an   -> author name, truncated to 12 characters w/ elipses
    ; %<(80,trunc)%s    -> commit subject, truncated to 80 characters w/ elipses
    ; %d                -> (removed) decorate output, i.e. origin/master...
    lg = log --format='%cd %C(auto)%h %<(12,trunc)%an %<(55,trunc)%s' --date=short

    ; delete branches that are merged with the current branch, not checked out
    ; in another worktree, whose names don't contain "master" or "release".
    rmmerged = !"git branch --merged | egrep -v '^[^ ]|release/|master' | xargs -n 1 git branch -d"

    ; in every repo reachable from cwd, do status and summarize results
    ; https://github.com/isao/shell/blob/master/git-statuscrazy.sh
    statuscrazy = !"find . -type d -name .git -execdir git-statuscrazy.sh \\;"

    ; Stash only the staged changes.
    ; From Hsieh Chin Fan https://github.com/typebrook/settings/blob/dev/gitconfig
    ; How it works:
    ; 1. Stash everything, but leave a copy of staged changes alone.
    ;       git stash --keep-index
    ; 2. Stash just the staged changes.
    ;       git stash
    ; 3. Restore the originally everything stash.
    ;       git stash pop stash@{1}
    ; 4. Remove the previously staged changes from the working area.
    ;       git stash show --patch | git apply --reverse
    stash-staged = !git stash --keep-index && \
       git stash && \
       git stash pop stash@{1} && \
       git stash show --patch | git apply --reverse

    # http://bit.ly/1Yx9OQM
    ;assume   = update-index --assume-unchanged
    ;unassume = update-index --no-assume-unchanged
    ;assumed  = '!git ls-files -v | grep ^h | cut -c 3-'

[github]
    user = isao
    password = !security find-generic-password -w -s github.password

; bbedit
[diff]
    tool = bbdiff
    algorithm = histogram
    compactionHeuristic = true

[difftool]
    prompt = no

[difftool "bbdiff"]
    cmd = bbdiff --wait --resume "$LOCAL" "$REMOTE"

[alias]
    bbdiff = difftool

[merge]
    tool = opendiff

[mergetool]
    prompt = no
    keepBackup = false

[mergetool "bbdiff"]
    cmd = bbdiff --wait --resume "$LOCAL" "$REMOTE"

[alias]
    bbmerge = mergetool

[filter "lfs"]
    clean = git-lfs clean %f
    smudge = git-lfs smudge %f
    required = true

[color]
	ui = auto
